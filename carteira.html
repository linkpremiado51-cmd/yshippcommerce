<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Carteira - YshippCommerce</title>

  <!-- Firebase compat (igual Ã s suas outras pÃ¡ginas) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <link href="https://fonts.googleapis.com/css2?family=Jura:wght@400;700&family=Ubuntu:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Copiei o estilo finalizado do seu design (dark/light) */
    :root{--background:#f9fafb;--surface:#ffffff;--text-primary:#1f2937;--text-secondary:#6b7280;--primary:#7c3aed;--primary-hover:#6d28d9;--secondary:#10b981;--secondary-hover:#059669;--border:#e5e7eb;--shadow:0 2px 4px rgba(0,0,0,0.1);--accent:#ff6b6b;--gold:#e67e22;--reais:#10b981;--tutorial-bg:#3498db;--tutorial-hover:#2980b9}
    [data-theme="dark"]{--background:#1f2937;--surface:#374151;--text-primary:#f3f4f6;--text-secondary:#9ca3af;--border:#4b5563;--shadow:0 2px 4px rgba(0,0,0,0.3);--accent:#ff8787;--gold:#e6a24b;--reais:#059669;--tutorial-bg:#1e90ff;--tutorial-hover:#1c86ee}
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Ubuntu',sans-serif;background:var(--background);color:var(--text-primary);min-height:100vh;display:flex;flex-direction:column;align-items:center}
    .header{background:var(--surface);border-bottom:1px solid var(--border);padding:1rem;width:100%;position:sticky;top:0;z-index:20;display:flex;justify-content:space-between;align-items:center}
    .header h1{font-family:'Jura',sans-serif;font-size:1.3rem;letter-spacing:1px}
    .theme-button{padding:.5rem 1rem;border-radius:.375rem;border:0;background:var(--tutorial-bg);color:#fff;cursor:pointer}
    .balance-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.2rem;width:100%;max-width:1200px;padding:1.2rem}
    .balance-card{border-radius:1rem;padding:1.6rem;color:#fff;position:relative;overflow:hidden;box-shadow:var(--shadow)}
    .balance-card.gold{background:linear-gradient(135deg,#f39c12,#e67e22)}
    .balance-card.reais{background:linear-gradient(135deg,#10b981,#059669)}
    .balance-label{font-size:.85rem;text-transform:uppercase;opacity:.9;margin-bottom:.4rem}
    .balance-amount{font-family:'Jura',sans-serif;font-size:2rem;font-weight:700}
    .wallet-section{width:100%;max-width:1200px;background:var(--surface);padding:1rem;border-radius:.5rem;margin:1rem 0;box-shadow:var(--shadow)}
    .wallet-section h2{font-family:'Jura',sans-serif;margin-bottom:.8rem}
    .action-buttons{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:.75rem;margin-bottom:1rem}
    .action-btn{padding:.9rem;border-radius:.5rem;border:0;font-weight:700;cursor:pointer}
    .action-btn.withdraw{background:var(--primary);color:#fff}
    .action-btn.transfer{background:#3b82f6;color:#fff}
    .action-btn.default{background:var(--secondary);color:#fff}
    .transaction-list{max-height:420px;overflow-y:auto}
    .transaction-item{display:flex;justify-content:space-between;align-items:center;padding:.8rem;border-radius:.5rem;border:1px solid var(--border);margin-bottom:.6rem;background:var(--background)}
    .transaction-type{font-weight:700}
    .transaction-desc{color:var(--text-secondary);font-size:.9rem}
    .transaction-date{color:var(--text-secondary);font-size:.8rem}
    .transaction-amount{font-weight:800}
    footer#userInfoFooter{position:fixed;bottom:0;left:0;width:100%;background:#07121a;color:#00ffb3;text-align:center;padding:.4rem;font-size:13px;z-index:999}
    .modal{display:none;position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,.6);justify-content:center;align-items:center;z-index:9999}
    .modal-content{background:var(--surface);padding:1.1rem;border-radius:.6rem;width:92%;max-width:520px}
    .form-group{margin-bottom:.8rem}
    .form-group label{display:block;margin-bottom:.3rem;font-weight:700}
    .form-group input,.form-group select{width:100%;padding:.6rem;border:1px solid var(--border);border-radius:.4rem}
    #loadingOverlay{position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;color:#fff;font-size:18px;z-index:10000}
    @media(max-width:600px){.balance-amount{font-size:1.5rem}}
  </style>
</head>
<body data-theme="light">
  <div id="loadingOverlay">Carregando carteira...</div>

  <header class="header">
    <h1>ðŸ’¼ Carteira - YshippCommerce</h1>
    <div>
      <button id="theme-toggle" class="theme-button">Alternar Tema</button>
    </div>
  </header>

  <main style="width:100%;max-width:1200px;padding:0 1rem 140px;">
    <div class="balance-cards">
      <div class="balance-card gold">
        <div class="balance-label">Saldo em Golds</div>
        <div id="golds-balance" class="balance-amount">0</div>
        <div style="opacity:.85">Moeda virtual do sistema</div>
      </div>
      <div class="balance-card reais">
        <div class="balance-label">Saldo em Reais</div>
        <div id="reais-balance" class="balance-amount">R$ 0,00</div>
        <div style="opacity:.85">Saldo disponÃ­vel para saque</div>
      </div>
    </div>

    <section class="wallet-section">
      <h2>EstatÃ­sticas</h2>
      <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:.8rem">
        <div style="padding:.8rem;border-radius:.5rem;border:1px solid var(--border);text-align:center">
          <div style="font-size:.8rem;color:var(--text-secondary)">Total Recebido</div>
          <div id="total-received" style="font-weight:800;font-family:'Jura',sans-serif">0</div>
        </div>
        <div style="padding:.8rem;border-radius:.5rem;border:1px solid var(--border);text-align:center">
          <div style="font-size:.8rem;color:var(--text-secondary)">Total Enviado</div>
          <div id="total-sent" style="font-weight:800;font-family:'Jura',sans-serif">0</div>
        </div>
        <div style="padding:.8rem;border-radius:.5rem;border:1px solid var(--border);text-align:center">
          <div style="font-size:.8rem;color:var(--text-secondary)">TransaÃ§Ãµes</div>
          <div id="total-transactions" style="font-weight:800;font-family:'Jura',sans-serif">0</div>
        </div>
        <div style="padding:.8rem;border-radius:.5rem;border:1px solid var(--border);text-align:center">
          <div style="font-size:.8rem;color:var(--text-secondary)">Ãšltimo Saque</div>
          <div id="last-withdrawal" style="font-weight:800;font-family:'Jura',sans-serif">-</div>
        </div>
      </div>
    </section>

    <section class="wallet-section">
      <h2>AÃ§Ãµes RÃ¡pidas</h2>
      <div class="action-buttons" style="margin-top:.8rem">
        <button class="action-btn default action-btn" onclick="openDepositModal()">ðŸ“¥ Depositar</button>
        <button class="action-btn withdraw" onclick="openWithdrawModal()">ðŸ“¤ Sacar</button>
        <button class="action-btn transfer" onclick="openTransferModal()">ðŸ’¸ Transferir</button>
        <button class="action-btn default" onclick="openConvertModal()">ðŸ”„ Converter</button>
      </div>
    </section>

    <section class="wallet-section">
      <h2>HistÃ³rico de TransaÃ§Ãµes</h2>
      <div id="transaction-list" class="transaction-list" style="margin-top:.6rem">
        <div style="text-align:center;color:var(--text-secondary);padding:1.5rem">Carregando transaÃ§Ãµes...</div>
      </div>
    </section>
  </main>

  <!-- Modais -->
  <div id="depositModal" class="modal"><div class="modal-content">
    <h3>ðŸ’° Depositar</h3>
    <div class="form-group"><label>MÃ©todo</label><select id="deposit-method"><option value="pix">PIX</option><option value="boleto">Boleto</option><option value="card">CartÃ£o</option></select></div>
    <div class="form-group"><label>Valor (R$)</label><input id="deposit-amount" type="number" min="1" step="0.01"></div>
    <div style="display:flex;gap:.6rem"><button class="action-btn default" onclick="processDeposit()">Confirmar</button><button class="action-btn" onclick="closeModal('depositModal')" style="background:#fff;color:#000;border:1px solid var(--border)">Cancelar</button></div>
  </div></div>

  <div id="withdrawModal" class="modal"><div class="modal-content">
    <h3>ðŸ“¤ Saque</h3>
    <div class="form-group"><label>Moeda</label><select id="withdraw-currency"><option value="reais">Reais</option><option value="golds">Golds</option></select></div>
    <div class="form-group"><label>Valor</label><input id="withdraw-amount" type="number" min="1" step="0.01"></div>
    <div class="form-group"><label>Chave PIX (destino)</label><input id="pix-key" type="text"></div>
    <div style="display:flex;gap:.6rem"><button class="action-btn withdraw" onclick="processWithdrawal()">Solicitar Saque</button><button class="action-btn" onclick="closeModal('withdrawModal')" style="background:#fff;color:#000;border:1px solid var(--border)">Cancelar</button></div>
  </div></div>

  <div id="transferModal" class="modal"><div class="modal-content">
    <h3>ðŸ’¸ Transferir</h3>
    <div class="form-group"><label>ID do destinatÃ¡rio</label><input id="recipient-id" type="text"></div>
    <div class="form-group"><label>Moeda</label><
